{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"TwistMethylFlow Documentation","text":"<p>Welcome to the TwistMethylFlow documentation. This Nextflow pipeline is designed for the analysis of Twist NGS Methylation data, encompassing quality control, alignment, methylation calling, differential methylation analysis, and post-processing.</p> <p></p> <p>For a detailed overview, please refer to the Overview section.</p>"},{"location":"faqs/","title":"FAQs","text":""},{"location":"faqs/#twistmethylflow-faqs","title":"TwistMethylFlow FAQs","text":""},{"location":"faqs/#pipeline-steps","title":"Pipeline Steps","text":""},{"location":"faqs/#generate-reference-genome","title":"Generate Reference Genome","text":"What is the purpose of Generate Reference Genome? <p>This step creates reference genome index files for Bismark, which are required for bisulfite read alignment.</p>"},{"location":"faqs/#raw-data-qc","title":"Raw Data QC","text":"How is raw sequencing data quality assessed? <p>Raw Data QC uses FastQC to evaluate per-base quality, GC content, adapter contamination, and other metrics.</p>"},{"location":"faqs/#adapter-trimming","title":"Adapter Trimming","text":"How should adapters and low-quality bases be handled? <p>Trim Galore removes adapters and low-quality bases from reads, ensuring high-quality data for alignment.</p>"},{"location":"faqs/#align-reads","title":"Align Reads","text":"How are reads aligned to the reference genome? <p>Bismark (Bowtie2) aligns bisulfite-treated reads to the reference genome. Accurate alignment is crucial for downstream methylation analysis.</p>"},{"location":"faqs/#deduplicate-removal","title":"Deduplicate Removal","text":"What is deduplicate removal? <p>Bismark removes PCR duplicates from aligned reads to prevent bias in methylation calling.</p>"},{"location":"faqs/#sort-and-indexing","title":"Sort and Indexing","text":"How are BAM files prepared after alignment? <p>Samtools sorts and indexes deduplicated BAM files for efficient access in downstream analyses.</p>"},{"location":"faqs/#extract-methylation-calls","title":"Extract Methylation Calls","text":"How are methylation calls extracted? <p>Bismark extracts cytosine methylation calls from aligned reads, generating the input for differential methylation analysis.</p>"},{"location":"faqs/#summary-report","title":"Summary Report","text":"How is the summary report generated? <p>Bismark summarizes alignment statistics and methylation extraction results, including conversion efficiency.</p>"},{"location":"faqs/#alignment-qc","title":"Alignment QC","text":"How is alignment quality assessed? <p>Qualimap generates metrics such as coverage, mapping quality, and duplication rate for aligned reads.</p>"},{"location":"faqs/#qc-reporting","title":"QC Reporting","text":"How are QC reports aggregated? <p>MultiQC compiles QC reports from FastQC, Bismark, and Qualimap into a single comprehensive report.</p>"},{"location":"faqs/#differential-methylation","title":"Differential Methylation","text":"How is differential methylation analysis performed? <p>EdgeR and MethylKit identify differentially methylated positions or regions, considering replicates and experimental design.</p>"},{"location":"faqs/#post-processing","title":"Post Processing","text":"How are results visualized? <p>ggplot2 creates summary plots like heatmaps, volcano plots, and coverage plots for differential methylation results.</p>"},{"location":"faqs/#go-analysis","title":"GO Analysis","text":"How is Gene Ontology analysis performed? <p>Functional enrichment analysis identifies pathways associated with differentially methylated genes, providing biological interpretation.</p>"},{"location":"faqs/#nextflow-workflow-concepts","title":"Nextflow Workflow Concepts","text":""},{"location":"faqs/#general-nextflow","title":"General Nextflow","text":"What is Nextflow? <p>Nextflow is a workflow management system for reproducible and scalable scientific pipelines. It allows users to define tasks and data flow using processes and channels.</p>"},{"location":"faqs/#processes","title":"Processes","text":"What are processes in Nextflow? <p>Processes encapsulate a task with defined inputs, outputs, and commands. They run independently and can scale across computing resources.</p>"},{"location":"faqs/#channels","title":"Channels","text":"What are channels in Nextflow? <p>Channels are asynchronous data streams that connect processes, passing input and output data between them.</p>"},{"location":"faqs/#outputs","title":"Outputs","text":"How do I define outputs in Nextflow? <p>Outputs are declared using the <code>output</code> block in processes or workflows. This defines what data is saved for downstream steps or exported from the workflow.</p>"},{"location":"faqs/#parallel-execution","title":"Parallel Execution","text":"How does Nextflow handle parallel execution? <p>Nextflow automatically runs independent processes in parallel based on available compute resources, enabling scalable execution.</p>"},{"location":"faqs/#reproducibility","title":"Reproducibility","text":"How does Nextflow ensure reproducibility? <p>Nextflow supports containerization (Docker/Singularity) and environment specification, ensuring the same pipeline produces identical results across systems.</p>"},{"location":"faqs/#workflow-profiles","title":"Workflow Profiles","text":"What are Nextflow profiles? <p>Profiles allow users to define environment-specific configurations, such as compute clusters, Docker images, and resource limits, for flexible pipeline execution.</p>"},{"location":"faqs/#learning-resources","title":"Learning Resources","text":"Where can I learn more about Nextflow? <ul> <li>Nextflow Documentation </li> <li>Nextflow Tutorials </li> <li>Hello Nextflow Training</li> </ul>"},{"location":"overview/","title":"Description","text":"<p>TwistMethylFlow integrates various tools and custom scripts to provide a comprehensive analysis workflow for Twist NGS Methylation data.</p> Step Tool/Software Description Generate Reference Genome Bismark Generate reference genome index files for bismark. Raw Data QC FastQC Performs quality control checks on raw sequence data. Adapter Trimming Trim Galore Trims adapters and low-quality bases from the reads. Align Reads Bismark (bowtie2) Aligns bisulfite-treated reads to a reference genome. Deduplicate removal Bismark Removes PCR duplicates from the aligned reads. Sort and Indexing Samtools Sorts the aligned and deduplicated BAM files. Extract Methylation Calls Bismark Extracts methylation calls from the aligned reads. Summary Report Bismark Generates a summary report of the Bismark alignment and methylation extraction. Alignment QC Qualimap Generates quality control metrics for the aligned reads. QC Reporting MultiQC Aggregates quality control reports from various steps into a single report. Differential Methylation EdgeR, MethylKit Performs differential methylation analysis using EdgeR and MethylKit package. Post Processing ggplot2 Generates summary statistics and visualizations of the differential methylation results. GO Analysis Gene Ontology Generates GOChord diagram from gene ontology analysis results."},{"location":"overview/#feature-details","title":"Feature Details","text":"<ol> <li>READ_PROCESSING: Checks the quality of raw sequencing data and trims low-quality bases and adapters to improve downstream analysis.</li> <li>BISMARK_ANALYSIS: Aligns bisulfite-converted reads to a reference genome, identifies and removes PCR duplicates, sorts and indexes the aligned reads, performs quality control on alignments, and extracts methylation information from the aligned reads.</li> <li>QC_REPORTING: Compiles quality control metrics from various steps into a comprehensive report for easy interpretation.</li> <li>DIFFERENTIAL_METHYLATION:</li> <li>EDGER_ANALYSIS:<ul> <li>Takes coverage files, a design file, and comparison information as input.</li> <li>Performs differential methylation analysis using the EdgeR Bioconductor package.</li> <li>Outputs CSV files with differential methylation results for each group comparison. METHYLKIT_ANALYSIS:</li> <li>Takes coverage files, a design file, and comparison information as input.</li> <li>Performs differential methylation analysis using the EdgeR Bioconductor package.</li> <li>Outputs CSV files with differential methylation results for each group comparison.</li> </ul> </li> <li>POST_PROCESSING:</li> <li>Reads the EdgeR results and generates:<ul> <li>Summary statistics (total DMRs, hyper/hypomethylated regions, significant DMRs)</li> <li>Volcano plot (visualizing fold change vs. significance)</li> <li>MA plot (visualizing intensity vs. fold change)</li> </ul> </li> <li> <p>Functional Analsysis</p> </li> <li> <p>Reads the EdgeR/MethylKit results and generates - </p> </li> <li>Top <code>n</code> corresponding genes from the EdgeR/MethylKit results are picked up to generate the gene ontology results.</li> <li>generates a CSV file with the GO classification results (only Biological Processes).</li> <li>generates a Chord diagram for top 10 results from the GO analysis.</li> </ol>"},{"location":"overview/#read-processing","title":"Read processing","text":"<p>Read processing subworkflow includes - </p> <ul> <li>FASTQC - for Quality check of samples</li> <li>TRIM Galore - adapter trimming</li> </ul>"},{"location":"overview/#fastqc","title":"FastQC","text":"<p>FASTQC is a widely used tool for assessing the quality of raw and processed sequencing data. It provides a comprehensive quality check, including metrics like per-base quality scores, GC content, and adapter contamination.</p> <pre><code>fastqc $args --threads $task.cpus $reads\n</code></pre> <p>General Options</p> <ul> <li><code>&lt;file{R1,R2}.fastq&gt;</code>: Input FASTQ files (gzip-compressed files, e.g., <code>file1.fastq.gz</code>, are also supported).</li> <li><code>-o &lt;output_directory&gt;</code>: Specify the directory where reports will be saved. Defaults to the current directory if omitted.</li> <li><code>-t &lt;number_of_threads&gt;</code>: Specify the number of threads for parallel processing.</li> </ul> FASTQC Results <ol> <li>HTML Report: Visual summary of the quality metrics.</li> <li>ZIP File: Contains the raw data used to generate the report.</li> </ol> <p>Key metrics in the HTML report:</p> <ul> <li>Per Base Sequence Quality:</li> <li>Boxplots showing quality scores across all positions in reads.</li> <li>Green indicates high-quality bases (&gt;Q30).</li> <li>Per Sequence Quality Scores:</li> <li>Overall quality of reads in the file.</li> <li>Per Base GC Content:</li> <li>GC content distribution across the length of reads.</li> <li>Adapter Content:</li> <li>Detects overrepresented adapter sequences.</li> <li>Overrepresented Sequences:</li> <li>Identifies frequently occurring sequences (e.g., adapters or contaminants).</li> </ul>"},{"location":"overview/#trim-galore","title":"Trim Galore","text":"<p>Trim Galore is a versatile tool for trimming sequencing reads and removing adapter sequences. It\u2019s particularly useful for preparing raw sequencing data for downstream applications like alignment or differential expression/methylation analysis. Trim Galore combines the functionalities of Cutadapt and FastQC for quality control and trimming.</p> <pre><code>trim_galore --paired --cores $task.cpus $args $reads\n</code></pre> <p>General Options</p> <ul> <li><code>-q &lt;quality&gt;</code>: Trim low-quality bases from the ends of reads. Default is <code>20</code>.</li> <li><code>--length &lt;min_length&gt;</code>: Discard reads shorter than the specified length after trimming.</li> <li><code>--adapter &lt;sequence&gt;</code>: Specify a custom adapter sequence. By default, Trim Galore auto-detects adapters.</li> <li><code>--gzip</code>: Compress the output files into <code>.gz</code> format.</li> <li><code>--fastqc</code>: Run FastQC before and after trimming.</li> <li><code>--cores &lt;number&gt;</code>: Use multiple cores for faster processing.</li> </ul>"},{"location":"overview/#bismark-analysis","title":"Bismark Analysis","text":""},{"location":"overview/#reference-genome-preparation","title":"Reference Genome Preparation","text":"<p>Bismark needs to prepare the bisulfite index for the genome.</p> <ul> <li>In the current pipeline, user can provide the <code>genome.fasta</code> and the pipeline can index it.</li> <li>Optinally, user can provide the index files directly, and the pipeline will use it without indexing the genome again.</li> </ul> <p>General Options</p> <ul> <li><code>--verbose</code>: Prints detailed output during the indexing process.</li> <li><code>--parallel &lt;threads&gt;</code>: Uses multiple threads to speed up genome preparation.</li> <li><code>--bowtie2</code>: Specifies that Bowtie2 will be used for alignment (default option in most versions).</li> <li><code>--path_to_bowtie &lt;path&gt;</code>: Specifies the path to the Bowtie installation if not in your <code>PATH</code>.</li> </ul> <p>Example with Options:</p> <pre><code>bismark_genome_preparation --bowtie2 --parallel 4 &lt;genome.fasta&gt;\n</code></pre> Reference Genome Preparation <p>After successful completion, Bismark generates a bisulfite-converted genome in two orientations (C-&gt;T and G-&gt;A) along with the Bowtie/Bowtie2 indices.</p> <p>Output directory structure:</p> <pre><code>your_path_to_reference/\n    Bisulfite_Genome/\n        CT_conversion/\n        GA_conversion/\n        genome.1.bt2\n        genome.2.bt2\n        ...\n</code></pre>"},{"location":"overview/#bismark-alignment","title":"Bismark Alignment","text":"<p>This step aligns bisulfite-treated sequencing reads to a reference genome.</p> <pre><code>bismark --genome &lt;path_to_reference_genome&gt; -1 &lt;reads_R1.fq&gt; -2 &lt;reads_R2.fq&gt; -o &lt;output_directory&gt;\n</code></pre> <p>General Options   * <code>--genome</code>: Path to the reference genome directory preprocessed with <code>bismark_genome_preparation</code>.   * <code>-1</code> and <code>-2</code>: Specify paired-end reads. Use <code>-U</code> for single-end reads.   * <code>-o</code>: Output directory for alignment files.</p> Bismark Alignment <ul> <li>Produces <code>.bam</code>  alignment files.</li> <li>Produces <code>.report.txt</code>  and</li> <li><code>unmapped_reads.fq.gz</code> file.</li> </ul>"},{"location":"overview/#bismark-deduplication","title":"Bismark Deduplication","text":"<p>This step removes duplicate reads to avoid overestimating methylation levels.</p> <pre><code>deduplicate_bismark ${paired_end} $args --bam $bam\n</code></pre> <p>General options:   * <code>args</code> options use all arguments from bismark deduplicate command.   * <code>--paired</code>: Use this for paired-end data. Remove for single-end reads.   * <code>--bam</code>: Specifies the input BAM file, generated from <code>bismark alignment</code></p> Bismark Deduplicate Removal <ul> <li>Generates a deduplicated <code>.bam</code> file.</li> <li>Produces <code>deduplicated_report.txt</code> file.</li> </ul>"},{"location":"overview/#bismark-methylation-extractor","title":"Bismark Methylation Extractor","text":"<p>Extract methylation data from deduplicated BAM files.</p> <pre><code>bismark_methylation_extractor \\\n    --bedGraph --gzip \\\n    -o &lt;output_directory&gt; &lt;deduplicated.bam&gt;\n</code></pre> <p>General options:   * <code>--bedGraph</code>: Generates bedGraph file   * <code>--gzip</code>: Compresses the output files.</p> Bismark Methylation Extractor <ul> <li>Generates <code>.bismark.cov.gz</code> files and methylation call data in CpG, CHG, and CHH contexts.</li> <li>Generates <code>bedGraph.gz</code> file.</li> <li>Also generates <code>splitting_report.txt</code> file.</li> </ul>"},{"location":"overview/#bismark-report","title":"Bismark Report","text":"<p>Generate a summary report of alignment and methylation statistics.</p> <p>Command:</p> <pre><code>bismark2report\n</code></pre> Bismark Report <p>Produces an HTML file summarizing:     * Alignment efficiency.     * Duplicate rates.     * Methylation levels (CpG, CHG, CHH contexts).</p>"},{"location":"overview/#alignment-quality-mapping","title":"Alignment Quality Mapping","text":"<p>The main module for assessing alignment quality is <code>qualimap bamqc</code>.</p> <pre><code>qualimap bamqc \\\n    -bam &lt;input.bam&gt; \\\n    -outdir &lt;output_directory&gt; \\\n    -outformat &lt;html&gt; \\\n    --java-mem-size\n</code></pre> <p>General Options:   * <code>-bam &lt;input.bam&gt;</code>: Path to the aligned BAM file (e.g., deduplicated BAM file).   * <code>-outdir &lt;output_directory&gt;</code>: Directory for output reports.   * <code>-outformat &lt;pdf|html&gt;</code>: Choose the output format for the report.</p> Alignment Quality Check <p>The output includes:</p> <ol> <li>General Alignment Statistics:</li> <li>Total number of reads.</li> <li>Percentage of mapped reads.</li> <li>Percentage of properly paired reads (for paired-end data).</li> <li>Coverage Statistics:</li> <li>Mean coverage depth.</li> <li>Percentage of the genome covered at varying depths (e.g., 1x, 5x, 10x).</li> <li>Insert Size Distribution (for paired-end reads):</li> <li>Provides insights into library preparation and sequencing quality.</li> <li>GC Content Distribution:</li> <li>Checks for bias in GC content distribution compared to expected values.</li> <li>Read Quality Metrics:</li> <li>Distribution of mapping quality scores.</li> </ol>"},{"location":"overview/#qc-reporting","title":"QC Reporting","text":"<p>MultiQC is used for the QC reporting combining all results from the FastQC, Trim galore, Bismark Alignment, Bismark Deduplication, Bismark summary report, and Qualimap results.</p> <p>Output:</p> <ul> <li>Generates an interactive HTML report (<code>multiqc_report.html</code>) and a data file (<code>multiqc_data.json</code>).</li> <li>Output includes summary statistics, plots, and tool-specific metrics.</li> </ul>"},{"location":"overview/#differential-methylation-analysis","title":"Differential Methylation Analysis","text":"<p>To calculate the differential methylation from the input samples, two different methods can be used - </p> <ul> <li>EdgeR (Default) or</li> <li>MethylKit</li> </ul>"},{"location":"overview/#edger","title":"EdgeR","text":"<p>edgeR is a Bioconductor package primarily used for RNA-seq differential expression analysis but can also handle differential methylation analysis when paired with bisulfite sequencing data. This requires pre-processed methylation data, such as counts of methylated (<code>M</code>) and unmethylated (<code>U</code>) reads at each cytosine position or region of interest.</p> <pre><code>Rscript $baseDir/bin/edgeR_analysis.R \\\n        --coverage_files '${coverage_files}' \\\n        --design \"${design_file}\" \\\n        --compare \"${compare_str}\" \\\n        --output . \\\n        --threshold ${coverage_threshold}\n</code></pre> <p>General options</p> <ul> <li><code>--coverage_files:</code> selected from the <code>bismark_methylation_extractor</code> files.</li> <li><code>--design</code>: selected from the <code>Sample_sheet.csv</code> </li> <li><code>--compare</code>: selected from the <code>Sample_sheet.csv</code> .</li> </ul> EdgeR Results <ul> <li>Generates <code>EdgeR_group_&lt;compare_str&gt;.csv</code>.</li> </ul>"},{"location":"overview/#methylkit","title":"MethylKit","text":"<p>MethylKit is an R package designed for analyzing bisulfite sequencing data, particularly for differential methylation analysis. It supports genome-wide methylation data and is ideal for CpG, CHH, and CHG methylation studies.</p> <pre><code>Rscript $baseDir/bin/run_methylkit.R \\\n        --coverage_files '${coverage_files}' \\\n        --design \"${design_file}\" \\\n        --compare \"${compare_str}\" \\\n        --output . \\\n        --threshold ${coverage_threshold}\n</code></pre> <p>General options</p> <ul> <li><code>--coverage_files:</code> selected from the <code>bismark_methylation_extractor</code> files.</li> <li><code>--design</code>: selected from the <code>Sample_sheet.csv</code> </li> <li><code>--compare</code>: selected from the <code>Sample_sheet.csv</code> .</li> </ul> MethylKit Results <ul> <li>Generates <code>Methylkit_group_&lt;compare_str&gt;.csv</code> </li> </ul>"},{"location":"overview/#post-processing","title":"Post-processing","text":"<p>Generates A) Volcano Plot, B) MA Plot and C) Summary Statistics from the Diffrential Methylation results.</p> Figures <p>Volcano Plot </p> <p>MA plot </p>"},{"location":"overview/#gene-ontology-analysis","title":"Gene Ontology Analysis","text":"<p>The pipeline has also a module to perform the Gene Ontology analysis from the top <code>n</code> corresponding genes from the differential methylation results (EdgeR/MethylKit) using the clusterProfiler package.</p> <p>The results generates a full table with all Biological Processes and a Chord diagram with top 10 functions identified in the analysis.</p> GOchord Diagram <p></p>"},{"location":"references/","title":"Citations","text":""},{"location":"references/#twistmethylflow","title":"TwistMethylFlow","text":"<p>Das, J. (2024). TwistMethylFlow (v1.0.0). Zenodo.  https://doi.org/10.5281/zenodo.14204261</p>"},{"location":"references/#pipeline-tools","title":"Pipeline tools","text":""},{"location":"references/#fastqc","title":"FastQC","text":"<p>Andrews, S. (2010). FastQC: A Quality Control Tool for High Throughput Sequence Data [Online].</p>"},{"location":"references/#trim-galore","title":"Trim Galore","text":"<p>Felix Krueger, Frankie James, Phil Ewels, Ebrahim Afyounian, Michael Weinstein, Benjamin Schuster-Boeckler, Gert Hulselmans, &amp; sclamons. (2023). FelixKrueger/TrimGalore: v0.6.10 - add default decompression path (0.6.10). Zenodo. https://doi.org/10.5281/zenodo.7598955</p>"},{"location":"references/#bismark","title":"Bismark","text":"<p>Krueger, F., &amp; Davies, R. (2019). Bismark: a versatile tool for aligning sequencing data to bisulfite-converted genomes. Bioinformatics, 35(4), 623-625. https://doi.org/10.1093/bioinformatics/bty724</p>"},{"location":"references/#samtools","title":"SAMtools","text":"<p>Danecek P, Bonfield JK, Liddle J, et al. Twelve years of SAMtools and BCFtools. GigaScience. 2021;10(2):giab008. doi:10.1093/gigascience/giab008</p>"},{"location":"references/#qualimap","title":"QualiMap","text":"<p>Konstantin Okonechnikov, Ana Conesa, Fernando Garc\u00eda-Alcalde, Qualimap 2: advanced multi-sample quality control for high-throughput sequencing data, Bioinformatics, Volume 32, Issue 2, January 2016, Pages 292\u2013294, https://doi.org/10.1093/bioinformatics/btv566</p>"},{"location":"references/#multiqc","title":"MultiQC","text":"<p>Ewels P, Magnusson M, Lundin S, K\u00e4ller M. MultiQC: summarize analysis results for multiple tools and samples in a single report. Bioinformatics. 2016 Oct 1;32(19):3047-8. doi: 10.1093/bioinformatics/btw354. Epub 2016 Jun 16. PubMed PMID: 27312411; PubMed Central PMCID: PMC5039924.</p>"},{"location":"references/#edger","title":"EdgeR","text":"<p>Chen Y, Chen L, Lun ATL, Baldoni P, Smyth GK (2025). \u201cedgeR v4: powerful differential analysis of sequencing data with expanded functionality and improved support for small counts and larger datasets.\u201d Nucleic Acids Research, 53(2), gkaf018. doi:10.1093/nar/gkaf018.</p>"},{"location":"references/#methylkit","title":"MethylKit","text":"<p>Morgan, M., &amp; Huber, W. (2020). methylKit: a package for the analysis of DNA methylation data in R. Bioinformatics, 36(1), 214-216.  https://doi.org/10.1093/bioinformatics/btz262</p>"},{"location":"references/#ggplot2","title":"ggplot2","text":"<p>Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org.</p>"},{"location":"references/#gene-ontology","title":"Gene Ontology","text":"<p>Xu S, Hu E, Cai Y, Xie Z, Luo X, Zhan L, Tang W, Wang Q, Liu B, Wang R, Xie W, Wu T, Xie L, Yu G (2024). \u201cUsing clusterProfiler to characterize multiomics data.\u201d Nature Protocols, 19(11), 3292-3320. doi:10.1038/s41596-024-01020-z, https://www.nature.com/articles/s41596-024-01020-z.</p> <p>Walter, Wencke, F\u00e1tima S\u00e1nchez-Cabo, and Mercedes Ricote. \"GOplot: an R package for visually combining expression data with functional analysis.\" Bioinformatics (2015): btv300.</p>"},{"location":"references/#software-packagingcontainerisation-tools","title":"Software packaging/containerisation tools","text":""},{"location":"references/#anaconda","title":"Anaconda","text":"<p>Anaconda Software Distribution. Computer software. Vers. 2-2.4.0. Anaconda, Nov. 2016. Web.</p>"},{"location":"references/#bioconda","title":"Bioconda","text":"<p>Gr\u00fcning B, Dale R, Sj\u00f6din A, Chapman BA, Rowe J, Tomkins-Tinch CH, Valieris R, K\u00f6ster J; Bioconda Team. Bioconda: sustainable and comprehensive software distribution for the life sciences. Nat Methods. 2018 Jul;15(7):475-476. doi: 10.1038/s41592-018-0046-7. PubMed PMID: 29967506.</p>"},{"location":"references/#biocontainers","title":"BioContainers","text":"<p>da Veiga Leprevost F, Gr\u00fcning B, Aflitos SA, R\u00f6st HL, Uszkoreit J, Barsnes H, Vaudel M, Moreno P, Gatto L, Weber J, Bai M, Jimenez RC, Sachsenberg T, Pfeuffer J, Alvarez RV, Griss J, Nesvizhskii AI, Perez-Riverol Y. BioContainers: an open-source and community-driven framework for software standardization. Bioinformatics. 2017 Aug 15;33(16):2580-2582. doi: 10.1093/bioinformatics/btx192. PubMed PMID: 28379341; PubMed Central PMCID: PMC5870671.</p>"},{"location":"references/#docker","title":"Docker","text":"<p>Merkel, D. (2014). Docker: lightweight linux containers for consistent development and deployment. Linux Journal, 2014(239), 2. doi: 10.5555/2600239.2600241.</p>"},{"location":"references/#nextflow","title":"Nextflow","text":"<p>Di Tommaso P, Chatzou M, Floden EW, Barja PP, Palumbo E, Notredame C. Nextflow enables reproducible computational workflows. Nat Biotechnol. 2017 Apr 11;35(4):316-319. doi: 10.1038/nbt.3820. PubMed PMID: 28398311.</p>"},{"location":"references/#r-and-bioconductor","title":"R and Bioconductor","text":"<p>R. Ihaka and R. Gentleman (1996), R: A Language for Data Analysis and Graphics, Journal of Computational and Graphical Statistics, Vol 5, No 3, 299-314.</p> <p>Huber, W., Carey, V., Gentleman, R. et al. Orchestrating high-throughput genomic analysis with Bioconductor. Nat Methods 12, 115\u2013121 (2015). https://doi.org/10.1038/nmeth.3252.</p>"},{"location":"references/#singularity","title":"Singularity","text":"<p>Kurtzer GM, Sochat V, Bauer MW. Singularity: Scientific containers for mobility of compute. PLoS One. 2017 May 11;12(5):e0177459. doi: 10.1371/journal.pone.0177459. eCollection 2017. PubMed PMID: 28494014; PubMed Central PMCID: PMC5426675.</p>"},{"location":"references/#authors-and-maintainers","title":"\ud83d\udc64 Authors and Maintainers","text":"Role Name &amp; Link Description Main Author Jyotirmoy Das Lead designer, developer, and overall coordinator for the TwistMethylFlow pipeline. Maintainer Jyotirmoy Das Actively maintaining the pipeline, fixing bugs, and implementing new features. Contributors All Contributors Thanks to everyone who helped in development, testing, and enhancement. Contributions welcome!"},{"location":"references/#citation","title":"\ud83d\udcc4 Citation","text":"<p>If you use TwistMethylFlow in your work, please cite:</p> <p>Das, J. (2024). TwistMethylFlow (v1.0.0). Zenodo. https://doi.org/10.5281/zenodo.14204261</p>"},{"location":"references/#help-faq-troubleshooting","title":"\u2753 Help, FAQ, Troubleshooting","text":"<ul> <li>Refer to the User Manual for detailed usage instructions and guidance.</li> <li>For bug reports, questions, or feature requests, please open an issue on GitHub.</li> </ul>"},{"location":"references/#license","title":"\ud83d\udcdc License","text":"<p>This project is licensed under the terms of the GNU General Public License v3.0.  </p>"},{"location":"references/#acknowledgements","title":"\ud83d\ude4f Acknowledgements","text":""},{"location":"references/#research-institutions","title":"Research Institutions","text":"<ul> <li> <p>Core Facility, Faculty of Medicine and Health Sciences, Link\u00f6ping University Link\u00f6ping University Core Facility</p> </li> <li> <p>Clinical Genomics Link\u00f6ping, Science for Life Laboratory, Sweden Clinical Genomics Link\u00f6ping</p> </li> <li> <p>National Academic Infrastructure for Supercomputing in Sweden (NAISS)</p> <p>The computations/data storage were enabled by resources provided by the National Academic Infrastructure for Supercomputing in Sweden (NAISS), partially funded by the Swedish Research Council through grant agreement no. 2022-06725.</p> </li> </ul> <p>These institutions provided invaluable resources and support for the development and testing of the TwistMethylFlow pipeline.</p>"},{"location":"references/#additional-thanks","title":"Additional Thanks","text":"<ul> <li>Open Source Community: Special thanks to the developers and contributors of Nextflow, Bismark, methylKit, EdgeR and other bioinformatics tools integrated into this pipeline.</li> <li>Users and Testers: A heartfelt thank you to all the early adopters, testers, and collaborators who helped refine and improve the tool through their feedback and bug reports.</li> </ul>"},{"location":"usage/","title":"Usage","text":"<p>The pipeline needs to use NextFlow, Singularity/Docker/Conda (for container). Details are given in corresponding pages.</p> <ul> <li>It is tested locally on Ubuntu server 24.04.2 LTS.</li> <li>Tested on HPC (Dardel from PDC, KTH)</li> </ul>"},{"location":"usage/#computational-requirements","title":"Computational Requirements","text":""},{"location":"usage/#softwares-requirements","title":"Software/s Requirements","text":"<ul> <li>Nextflow (&gt;=21.10.3)</li> <li>Docker or Singularity (for containerized execution)</li> <li>Java (&gt;=8)</li> </ul>"},{"location":"usage/#hardware-requirements","title":"Hardware Requirements","text":"<ul> <li>RAM: 6 GB - 200 GB</li> <li>CPU: min. 12 cores</li> <li>Storage: ~2TB for 24 paired-end samples</li> </ul>"},{"location":"usage/#run-nextflow","title":"Run NextFlow","text":"<pre><code>nextflow run JD2112/TwistMethylFlow \\\n    -profile singularity \\\n    --sample_sheet Sample_sheet_twist.csv \\\n    --genome_fasta /data/reference_genome/hg38/hg38.fa \\ \n    --run_both_methods \\\n    --gtf_file /data/Homo_sapiens.GRCh38.104.gtf \\\n    --refseq_file /data/hg38_RefSeq.bed.gz \\\n    --outdir Results/TwistMethylFlow_both \n</code></pre> additional options <p>Run with pre-build reference genome index <code>--bismark_index /data/reference_genome/hg38/</code></p> <p>Run only EdgeR <code>--diff_meth_method edger</code></p> <p>Run only MethylKit <code>--diff_meth_method methylkit</code></p> need annotation files <p>Remember to add annotation files for different differential methylation analysis</p> <p><code>--gtf_file /data/Homo_sapiens.GRCh38.104.gtf</code> for MethylKit </p> <p><code>--refseq_file /data/hg38_RefSeq.bed.gz</code> for EdgeR</p> Help <pre><code>nextflow run main.nf --help --outdir .\n</code></pre>"},{"location":"usage/#parameters-configuration","title":"Parameters configuration","text":"<p>User can change the <code>conf/params.config</code> or use the <code>--</code> flags directly on nextflow command line.</p> options Description <code>--sample_sheet</code> Path to the sample sheet CSV file (required) <code>--bismark_index</code> Path to the Bismark index directory (required unless <code>--genome</code> or <code>--aligned_bams</code> is provided) <code>--genome</code> Path to the reference genome FASTA file (required if <code>--bismark_index</code> not provided) <code>--aligned_bams</code> Path to aligned BAM files (use this to start from aligned BAM files instead of FASTQ files) <code>--refseq_file</code> Path to RefSeq file for annotation (reuired to run <code>both</code> or <code>methylkit</code>) <code>--gtf_file</code> Path to GTF file for annotation (reuired to run <code>both</code> or <code>edger</code>) <code>--outdir</code> Output directory (default: ./results) <code>--diff_meth_method</code> Differential methylation method to use: 'edger' or 'methylkit' (default: edger) <code>--run_both_methods</code> Run both edgeR and methylkit for differential methylation analysis (default: false) <code>--skip_diff_meth</code> Skip differential methylation analysis (default: false) <code>--coverage_threshold</code> Minimum read coverage to consider a CpG site (default: 10) <code>--logfc_cutoff</code> Differential methylation cut-off for Volcano or MA plot (default: 1.5) <code>--pvalue_cutoff</code> Differential methylation P-value cut-off for Volcano or MA plot (default: 0.05) <code>--hyper_color</code> Hypermethylation color for Volcano or MA plot (default: red) <code>--hypo_cutoff</code> Hypomethylation color for Volcano or MA plot (default: blue) <code>--nonsig_color</code> Non-significant color for Volcano or MA plot (default: black) <code>--compare_str</code> Comparison string for differential analysis (e.g. \"Group1-Group2\") <code>--top_n_genes</code> Number of top differentially methylated genes to report for GOplot (default: 100) <code>--help</code> Show this help message and exit MethylKit specific parameters <p><code>--assembly</code> - user needs to provide the genome assembly version. Default: <code>hg38</code></p> <p><code>--mc_cores</code> - if required to run on multiple cores. Default: <code>1</code></p> <p><code>--diff</code> - Differential methylation cutoff value. Default: <code>0.5</code></p> <p><code>--qvalue</code> - qvalue respect to differential methylation value to identify significant CpGs. Default: <code>0.05</code></p> Other parameters configuration <ol> <li><code>conf/resource.config</code> - for resource settings.</li> <li><code>conf/base.config</code> - for base settings.</li> <li><code>nextflow.config</code> - for nextflow run with default setting.</li> <li><code>dag.config</code> - for DAG configuration settings.</li> </ol>"},{"location":"usage/#input-file","title":"Input File","text":"<p>Sample sheet (CSV format) with sample information</p> <p><code>Sample_sheet.csv</code>:</p> sample_id group read1 read2 SN09 Healthy FASTQ/SN09/SL1_S9_R1_001.fastq.gz FASTQ/SN09/SL1_S9_R2_001.fastq.gz SN10 Disease FASTQ/SN10/SL2_S10_R1_001.fastq.gz FASTQ/SN10/SL2_S10_R2_001.fastq.gz SN11 Healthy FASTQ/SN11/SL3_S11_R1_001.fastq.gz FASTQ/SN11/SL3_S11_R2_001.fastq.gz SN12 Disease FASTQ/SN12/SL4_S12_R1_001.fastq.gz FASTQ/SN12/SL4_S12_R2_001.fastq.gz SN13 Healthy FASTQ/SN13/SL5_S13_R1_001.fastq.gz FASTQ/SN13/SL5_S13_R2_001.fastq.gz SN14 Disease FASTQ/SN14/SL6_S14_R1_001.fastq.gz FASTQ/SN14/SL6_S14_R2_001.fastq.gz"},{"location":"usage/#results","title":"Results","text":"<p>Here is how the result folder looks like -</p> <pre><code>.\n\u251c\u2500\u2500 annotate_results\n\u251c\u2500\u2500 bismark_align\n\u251c\u2500\u2500 bismark_deduplicate\n\u251c\u2500\u2500 bismark_genome_preparation\n\u251c\u2500\u2500 bismark_methylation_extractor\n\u251c\u2500\u2500 bismark_report\n\u251c\u2500\u2500 edger_analysis\n\u251c\u2500\u2500 fastqc\n\u251c\u2500\u2500 go_analysis\n\u251c\u2500\u2500 multiqc\n\u251c\u2500\u2500 pipeline_info\n\u251c\u2500\u2500 post_processing\n\u251c\u2500\u2500 qualimap\n\u251c\u2500\u2500 samtools_index\n\u251c\u2500\u2500 samtools_sort\n\u2514\u2500\u2500 trim_galore\n</code></pre> bismark alignment with bowtie2 Option Functionality <code>-q</code> Quiet mode: suppresses detailed output. <code>--score-min L,0,-0.2</code> Sets a linear minimum score for valid alignments (moderate stringency). <code>--ignore-quals</code> Ignores base quality scores during alignment. <code>--no-mixed</code> Ensures both ends of paired reads align properly; no single-end alignments. <code>--no-discordant</code> Prevents discordant alignments; enforces proper orientation and distance. <code>--dovetail</code> Allows overlapping or extended alignments in paired-end reads. <code>--maxins 500</code> Sets the maximum allowed distance between paired-end reads to 500 bases."}]}